---
- name: Provisioning server for hosting application
  hosts: app
  become: yes

  pre_tasks:
    - name: Updating installed packages
      ansible.builtin.package:
        update_cache: yes
        upgrade: yes

  tasks:
    - name: Installing required packages
      ansible.builtin.package:
        name: 
          - htop
          - tmux
          - neovim
          - rsync
        state: latest

    - name: Creating test user
      ansible.builtin.user:
        name: test
        password: 'test'
        groups: # Empty by default, here we give it some groups
        - docker
        - sudo
        state: present

    - name: Creating Folders
      file:
        path: /home/test/{{ item.path }} 
        mode: "{{ item.mode  }}"
        state: directory
      with_items:
        - { path: "app_config_files", mode: "u=rwX,g=rwX,o=rwX" }
        - { path: "production_documentation", mode: "u=rwX,g=rwX,o=rwX" }
