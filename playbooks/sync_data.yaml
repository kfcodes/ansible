---
- name: Synchronize data
  hosts: app

  tasks:

  - name: Synchronize local application and config files with remote server
    ansible.posix.synchronize:
      checksum: true
      src: ~/.configFiles/{{ item.name }}
      dest: /home/test/.configFiles/{{ item.dest }}
    with_items:
        - { name: "fastAPI.env", dest: "fastAPI.env"}
        - { name: "nodejs.env", dest: "nodejs.env"}
        - { name: "reactApp.env", dest: "reactApp.env"}


  - name: Synchronize remote server backup data with local system
    ansible.posix.synchronize:
      checksum: true
      mode: pull
      src: /home/m/sqlBackupData/
      dest: ~/.backupdata/

  - name: Synchronize remote server production documentation with local system
    ansible.posix.synchronize:
      checksum: true
      mode: pull
      src: /home/test/.productionDocumentation/
      dest: ~/.productionDocumentation/

  - name: Create cron job to run every hour to backup DB
    ansible.builtin.cron:
      name: Create cron job to run every hour to backup DB
      special_time: hourly
      job: "/home/m/backup_sql_database.sh"
